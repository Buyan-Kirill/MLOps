# MLOps
Проект, выполненный в рамках задания по курсу MLOps

В рамках проекта предполагается создать рекомендательную систему, которая по введённому пользователем названию произведения и автору должна предложить другие произведения, которые могут быть ему интересны.

В качестве датасета используется GoodReads Best Books датасет (https://www.kaggle.com/datasets/thedevastator/comprehensive-overview-of-52478-goodreads-best-b/data) в котором содержится множество книг с их подробной инофрмацие о каждой из них, а также Goodreads Book Datasets With User Rating 2M (https://www.kaggle.com/datasets/bahramjannesarr/goodreads-book-datasets-10m/data), в котором есть таблицы с различными книгами и их характеристиками, а также таблицы с отзывами пользователей о различных книгах. Из обоих датасетов формируется один, содержащий подробные качественные описания книг и рейтинги пользователей, поставленные этим книгам.

Предположим, что сейчас рекомендации строятся просто на основе среднего рейтинга книг: пользователю рекомендуется книга с наивысшим рейтингом среди тех, что он ещё не читал. Задача: улучшить рекомендации путём персонализации рекомендаций для пользователей на основе их истории. Для этого предполагается построить информативные эмбединги книг, после чего, используя эти эмбединги и поставленные соответствующим книгам рейтинги, делать персонализированные рекомендации книг. В силу того, что в таблице рейтингов пользователей нет информации о времени, а также нет возможности получения новых рейтингов для проведения A/B-теста для сравнения подходов, оценка качества происходит путём сравнения корелляции между вектором предсказаний рейтингов книг, которых нет в историии пользователя, и известными истинными оценками.

Для построения информативных векторных эмбедингов использовался предобученный энкоде трансформера и последующая нейросеть для проекции в меньшую размерность, обученную на TripletLoss по косинусному сходству. Далее предсказание рейтинга книги на основе истории пользователя происходит уже без нейросетевых методов, обучаемым там является только коэффициент, отвечающий за баланс между учитыванием персональных предпочтений пользователя и среднего рейтинга книги.

Для запуска проекта необходимо скачать датасет. Для этого можно либо напрямую скачать GoodReads Best Books датасет в папку ./data/best_books_dataset, а датасет Book Datasets With User Rating 2M  в папку ./data/all_books_dataset, либо выполнить следующие шаги для автоматического скачивания из kaggle:
1) Скачайте kaggle.json с https://www.kaggle.com/settings/account → API
2) mkdir -p ~/.kaggle
3) mv ~/Downloads/kaggle.json ~/.kaggle/
4) chmod 600 ~/.kaggle/kaggle.json
После этого всю дальнейшую работу можно будет делать через Makefile. Там есть команды для запуска полного цикла:
1) создание виртуального окружения (make setup)
2) загрузка (если не скачаны) и очистка данных (make prepare_data)
3) первоначальное создание эмбеддингов с помощью обученного энкодера трансформера (make embed)
4) обучение модели для создания более информативных эмбеддингов (make train)
5) применение обученной модели для создания эмбеддингов книг (make encode_embeddings)
6) сравнение полученных с помощью обученной нейросети эмбеддингов с первоначальными (make test_embeddings)
7) подбор коэфициента при взвешивание популярности книги и сравнение нового подхода с базовым (рекомендация самого популярного)
8) рекомендация книги пользователю по названиям книг, авторам и оценкам, поставленным этим книгам. Итоговая цель - рекомендательная система (make recommend)
Для полного запуска используется (make all)
Также можно запустить очистку (make clean для очистки и make clean-all для удаления виртуального окружения в том числе) и проверку пайплайна (make test_pipeline).
В том числе была реализована автоматический запуск проверок при коммите и пуше. В качестве подтверждения в репозитории приложены изображения Correct.png и Incorrect.png, которые показывают поведение системы при корректном и ннекорректном коммите.
